<!doctype html>
<html>
  <head>
  </head>

  <body>
    <script type="text/javascript" src="lib/system.js"></script>
    <script type="text/javascript" src="lib/virtual-dom.js"></script>

    <script type="text/javascript" src="App.js"></script>

    <script type="text/javascript">
      var calculateLocationHash = function() {
        return window.location.hash || '#/';
      };

      var Link = function(href, children) {
        return h('a', {href: href}, children);
      };

      var state = {
        hash: calculateLocationHash(),
        routePaths: {
          '#/': './components/Home.js',
          '#/about': './components/About.js'
        }
      };

      var render = function(state) {
        return Promise.all([
          SystemJS.import('./components/Router.js'),
          SystemJS.import('./components/Container.js')
        ])
        .then(function(results) {
          var Router = results[0];
          var Container = results[1];

          return Router.render(state)
            .then(function(children) {
              return Container.render(state, children);
            });
        });
      };

      var app = new App(state, render);

      window.addEventListener('hashchange', function() {
        app.state.hash = calculateLocationHash();
      });
    </script>
  </body>
</html>